=================================================
               CCF TCARCH Self-Test              
=================================================
Job started on mi100-1 at Thu Sep 11 07:23:14 AM UTC 2025

STEP 1: Compiling source code...
kernel.hip:102:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  102 |     hipMalloc(&d_input, N * sizeof(float));
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:103:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  103 |     hipMalloc(&d_output, N * sizeof(float));
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:104:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  104 |     hipMalloc(&d_maxValues, numBlocks * sizeof(float));
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:105:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  105 |     hipMalloc(&d_expSums, numBlocks * sizeof(float));
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:108:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  108 |     hipMemcpy(d_input, input, N * sizeof(float), hipMemcpyHostToDevice);
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:116:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  116 |     hipMemcpy(maxValues.data(), d_maxValues, numBlocks * sizeof(float), hipMemcpyDeviceToHost);
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:131:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  131 |     hipMemcpy(expSums.data(), d_expSums, numBlocks * sizeof(float), hipMemcpyDeviceToHost);
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:146:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  146 |     hipMemcpy(output, d_output, N * sizeof(float), hipMemcpyDeviceToHost);
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:149:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  149 |     hipFree(d_input);
      |     ^~~~~~~ ~~~~~~~
kernel.hip:150:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  150 |     hipFree(d_output);
      |     ^~~~~~~ ~~~~~~~~
kernel.hip:151:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  151 |     hipFree(d_maxValues);
      |     ^~~~~~~ ~~~~~~~~~~~
kernel.hip:152:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  152 |     hipFree(d_expSums);
      |     ^~~~~~~ ~~~~~~~~~
12 warnings generated when compiling for gfx908.
kernel.hip:102:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  102 |     hipMalloc(&d_input, N * sizeof(float));
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:103:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  103 |     hipMalloc(&d_output, N * sizeof(float));
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:104:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  104 |     hipMalloc(&d_maxValues, numBlocks * sizeof(float));
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:105:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  105 |     hipMalloc(&d_expSums, numBlocks * sizeof(float));
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:108:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  108 |     hipMemcpy(d_input, input, N * sizeof(float), hipMemcpyHostToDevice);
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:116:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  116 |     hipMemcpy(maxValues.data(), d_maxValues, numBlocks * sizeof(float), hipMemcpyDeviceToHost);
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:131:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  131 |     hipMemcpy(expSums.data(), d_expSums, numBlocks * sizeof(float), hipMemcpyDeviceToHost);
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:146:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  146 |     hipMemcpy(output, d_output, N * sizeof(float), hipMemcpyDeviceToHost);
      |     ^~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
kernel.hip:149:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  149 |     hipFree(d_input);
      |     ^~~~~~~ ~~~~~~~
kernel.hip:150:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  150 |     hipFree(d_output);
      |     ^~~~~~~ ~~~~~~~~
kernel.hip:151:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  151 |     hipFree(d_maxValues);
      |     ^~~~~~~ ~~~~~~~~~~~
kernel.hip:152:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
  152 |     hipFree(d_expSums);
      |     ^~~~~~~ ~~~~~~~~~
12 warnings generated when compiling for host.
Compilation successful. Executable 'softmax' created.

STEP 2: Running test cases...
Found 10 test cases in testcases
-------------------------------------------------
Running test [10]... PASS (1.12s)
Running test [1]... PASS (0.47s)
Running test [2]... PASS (0.48s)
Running test [3]... PASS (0.46s)
Running test [4]... PASS (0.49s)
Running test [5]... PASS (0.49s)
Running test [6]... PASS (0.46s)
Running test [7]... PASS (0.46s)
Running test [8]... PASS (0.47s)
Running test [9]... PASS (1.12s)
-------------------------------------------------
FINAL RESULT: ALL TESTS PASSED!

    Passed cases: 10 / 10
    Total execution time: 6.02 seconds

Job finished at Thu Sep 11 07:23:26 AM UTC 2025
=================================================
